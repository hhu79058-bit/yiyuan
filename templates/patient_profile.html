{% extends "base.html" %}
{% block title %}我的档案 - 诊疗通{% endblock %}

{% block content %}
    <div class="card">
        <div class="page-title">
            <div>
                <h2>我的档案</h2>
                <div class="subtitle">维护过敏史与既往病史，便于医生诊疗参考</div>
            </div>
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
                <a class="btn btn--ghost btn--sm" href="{{ url_for('registration.patient_home') }}">返回首页</a>
                <a class="btn btn--ghost btn--sm" href="{{ url_for('cashier.patient_payments') }}">收银台</a>
            </div>
        </div>

        {% if patient %}
            <div class="muted" style="margin-top:6px;">
                姓名：{{ patient.name }} ｜ 性别：{{ patient.gender }} ｜ 年龄：{{ patient.age }} ｜ 病历号：<span class="mono">{{ patient.medical_record_no }}</span>
                <br>手机号：{{ patient.phone }}
            </div>
        {% endif %}

        <form method="POST" action="{{ url_for('patients.patient_profile') }}" style="margin-top:12px;">
            <label>过敏史</label>
            <textarea name="allergy" placeholder="如：青霉素过敏，海鲜过敏">{{ patient.allergy if patient else '' }}</textarea>

            <label>既往病史</label>
            <textarea name="past_illness" placeholder="如：高血压、糖尿病等">{{ patient.past_illness if patient else '' }}</textarea>

            <div style="margin-top:12px;">
                <button class="btn btn--primary" type="submit">保存</button>
            </div>
        </form>
    </div>
{% endblock %}
